(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-41e11cfe"],{5919:function(t,e,n){"use strict";n.d(e,"c",(function(){return a})),n.d(e,"d",(function(){return i})),n.d(e,"a",(function(){return o})),n.d(e,"e",(function(){return s})),n.d(e,"b",(function(){return c}));var r=n("b775");function a(t){return Object(r["a"])({url:"/domain/list",method:"get",params:t})}function i(){return Object(r["a"])({url:"/domain/manufacturer/list",method:"get"})}function o(t){return Object(r["a"])({url:"/domain/add",method:"put",data:t})}function s(t){return Object(r["a"])({url:"/domain/edit",method:"post",data:t})}function c(t){return Object(r["a"])({url:"/domain/delete/".concat(t),method:"delete"})}},"7db0":function(t,e,n){"use strict";var r=n("23e7"),a=n("b727").find,i=n("44d2"),o=n("ae40"),s="find",c=!0,l=o(s);s in[]&&Array(1)[s]((function(){c=!1})),r({target:"Array",proto:!0,forced:c||!l},{find:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),i(s)},aa22:function(t,e,n){"use strict";n.d(e,"d",(function(){return a})),n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return o})),n.d(e,"b",(function(){return s}));var r=n("b775");function a(t){return Object(r["a"])({url:"/server/list",method:"get",params:t})}function i(t){return Object(r["a"])({url:"/server/add",method:"put",data:t})}function o(t){return Object(r["a"])({url:"/server/edit",method:"post",data:t})}function s(t){return Object(r["a"])({url:"/server/delete/".concat(t),method:"delete"})}},c464:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"primary"},on:{click:t.onAdd}},[t._v("新增")]),n("el-popconfirm",{staticStyle:{"margin-left":"10px"},attrs:{title:"确定刷新证书吗？","confirm-button-text":"确认","cancel-button-text":"取消"},on:{confirm:function(e){return t.refresh()}}},[n("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{slot:"reference",type:"primary",icon:"el-icon-refresh"},slot:"reference"},[t._v("手动刷新所有证书")])],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],attrs:{data:t.list,"element-loading-text":"拼命加载中",border:"",fit:"","highlight-current-row":""}},[n("el-table-column",{attrs:{align:"center",label:"id",width:"95"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[n("a",{staticClass:"link-type",on:{click:function(e){return t.onEdit(r)}}},[t._v(t._s(r.id))])]}}])}),n("el-table-column",{attrs:{label:"域名",width:"210"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[n("a",{staticClass:"link-type",on:{click:function(e){return t.onEdit(r)}}},[t._v(t._s(r.certificate_domain))])]}}])}),n("el-table-column",{attrs:{label:"创建时间",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[n("a",{staticClass:"link-type",on:{click:function(e){return t.onEdit(r)}}},[t._v(t._s(r.register_time))])]}}])}),n("el-table-column",{attrs:{label:"到期时间",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[n("a",{staticClass:"link-type",on:{click:function(e){return t.onEdit(r)}}},[t._v(t._s(r.exp_time))])]}}])}),n("el-table-column",{attrs:{label:"证书天数",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[n("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:t.getSurplusDay(r.remainder_days),placement:"top"}},[n("el-progress",{attrs:{"text-inside":!0,"stroke-width":24,percentage:t.getPercentage(r.percentage),status:t.getStatus(r.percentage)}})],1)]}}])}),n("el-table-column",{attrs:{label:"状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[n("el-tag",{attrs:{type:t.getStatusTagType(r.status)}},[t._v(t._s(t.getStatusString(r.status)))])]}}])}),n("el-table-column",{attrs:{label:"操作",align:"center",width:"400"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[n("el-button",{attrs:{type:"primary",icon:"el-icon-edit"},on:{click:function(e){return t.onEdit(r)}}},[t._v("编辑")]),n("el-popconfirm",{staticStyle:{"margin-left":"10px"},attrs:{title:t.getEditSslStatusTitle(r.status),"confirm-button-text":"确认","cancel-button-text":"取消"},on:{confirm:function(e){return t.onEditSslStatus(r.id,r.status)}}},[n("el-button",{attrs:{slot:"reference",type:"danger"},slot:"reference"},[t._v(t._s(0===r.status?"打开":"关闭"))])],1),n("el-popconfirm",{staticStyle:{"margin-left":"10px"},attrs:{title:"确定删除吗？","confirm-button-text":"确认","cancel-button-text":"取消"},on:{confirm:function(e){return t.handleDelete(r.id)}}},[n("el-button",{attrs:{slot:"reference",type:"danger",icon:"el-icon-delete"},slot:"reference"},[t._v("删除")])],1),n("el-popconfirm",{staticStyle:{"margin-left":"10px"},attrs:{title:"确定刷新该条数据吗？","confirm-button-text":"确认","cancel-button-text":"取消"},on:{confirm:function(e){return t.single_refresh(r.id)}}},[n("el-button",{attrs:{slot:"reference",type:"primary",icon:"el-icon-refresh"},slot:"reference"},[t._v("刷新")])],1)]}}])})],1),n("el-dialog",{attrs:{"close-on-click-modal":!1,title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[n("el-form",{ref:"dataForm",staticStyle:{width:"400px","margin-left":"50px"},attrs:{model:t.temp,"label-position":"left","label-width":"100px"}},[n("el-form-item",{attrs:{label:"主域名",prop:"first_domain_id"}},[n("el-select",{attrs:{filterable:"",placeholder:"请选择主域名"},on:{change:function(e){return t.changeDomain(t.domainValueId)}},model:{value:t.domainValueId,callback:function(e){t.domainValueId=e},expression:"domainValueId"}},t._l(t.chooseDomainList,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),n("el-form-item",{attrs:{label:"服务器",prop:"certificate_domain"}},[n("el-select",{attrs:{multiple:"",placeholder:"请选择服务器"},on:{change:function(e){return t.changeServer(t.serverValue)}},model:{value:t.serverValue,callback:function(e){t.serverValue=e},expression:"serverValue"}},t._l(t.chooseServerList,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),n("el-form-item",{attrs:{label:"域名",prop:"certificate_domain"}},[n("el-input",{model:{value:t.temp.certificate_domain,callback:function(e){t.$set(t.temp,"certificate_domain",e)},expression:"temp.certificate_domain"}})],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v(" 关闭 ")]),n("el-button",{attrs:{type:"primary"},on:{click:function(e){"create"===t.dialogStatus?t.createData():t.updateData()}}},[t._v(" 确认 ")])],1)],1)],1)},a=[],i=n("c7eb"),o=n("1da1"),s=(n("7db0"),n("b64b"),n("d3b7"),n("b775"));function c(t){return Object(s["a"])({url:"/ssl/list",method:"get",params:t})}function l(t){return Object(s["a"])({url:"/ssl/add",method:"put",data:t})}function u(t){return Object(s["a"])({url:"/ssl/edit",method:"post",data:t})}function d(t){return Object(s["a"])({url:"/ssl/edit_status",method:"post",data:t})}function f(t){return Object(s["a"])({url:"/ssl/delete/".concat(t),method:"delete"})}function m(){return Object(s["a"])({url:"/ssl/refresh",method:"post"})}function p(t){return Object(s["a"])({url:"/ssl/refresh/".concat(t),method:"post"})}var h=n("5919"),b=n("aa22"),g={filters:{statusFilter:function(t){var e={published:"success",draft:"gray",deleted:"danger"};return e[t]}},data:function(){return{list:null,listLoading:!0,dialogFormVisible:!1,dialogStatus:"",textMap:{update:"编辑",create:"新增"},temp:{id:void 0,first_domain_id:void 0,server_ids:[],certificate_domain:""},domainValueId:void 0,serverValue:[],chooseDomainList:[],chooseServerList:[],serverData:[],domainData:[]}},created:function(){this.getSslList()},methods:{refresh:function(){var t=this;this.listLoading=!0,m().then((function(e){0===e.code&&(t.listLoading=!1,t.getSslList())}))},single_refresh:function(t){var e=this;this.listLoading=!0,p(t).then((function(t){0===t.code&&(e.listLoading=!1,e.getSslList())}))},getDomainList:function(){var t=this;return Object(o["a"])(Object(i["a"])().mark((function e(){return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(h["c"])().then((function(e){0===e.code&&(t.domainData=e.data.items)}));case 2:case"end":return e.stop()}}),e)})))()},getServerList:function(){var t=this;return Object(o["a"])(Object(i["a"])().mark((function e(){return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(b["d"])().then((function(e){0===e.code&&(t.serverData=e.data.items)}));case 2:case"end":return e.stop()}}),e)})))()},getSslList:function(){var t=this;this.listLoading=!0,c().then((function(e){0===e.code&&(t.list=e.data.items,t.listLoading=!1)}))},getStatus:function(t){return t<10?"exception":t>=10&&t<30?"warning":"success"},getPercentage:function(t){return null===t?0:parseFloat(t)},getSurplusDay:function(t){return null===t?"您还没申请过呢~":"剩余 "+t+"  天"},createData:function(){var t=this;l(this.temp).then((function(e){0===e.code&&(t.dialogFormVisible=!1,t.getSslList())}))},changeDomain:function(t){this.temp.first_domain_id=t;var e=this.domainData.find((function(e){return e.id===t}));this.temp.certificate_domain=e.domain},changeServer:function(t){this.temp.server_ids=t},updateData:function(){var t=this;"string"===typeof this.temp.server_ids&&(this.temp.server_ids=JSON.parse(this.temp.server_ids)),u(this.temp).then((function(e){0===e.code&&(t.dialogFormVisible=!1,t.getSslList())}))},getStatusString:function(t){switch(t){case 0:return"不进行续期";case 1:return"正常";case 2:return"新建/过期"}},getStatusTagType:function(t){switch(t){case 0:return"info";case 1:return"success";case 2:return"warning"}},getEditSslStatusTitle:function(t){return 0===t?"确定打开吗？":"确定关闭吗？"},onEditSslStatus:function(t,e){var n,r=this;n=0===e?1:0;var a={id:t,status:n};d(a).then((function(t){0===t.code&&r.getSslList()}))},onEdit:function(t){var e=this;return Object(o["a"])(Object(i["a"])().mark((function n(){return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.getFromData();case 2:e.resetTemp(),e.temp=Object.assign({},t),e.domainValueId=e.temp.first_domain_id,e.serverValue=JSON.parse(e.temp.server_ids),e.dialogFormVisible=!0,e.dialogStatus="update";case 8:case"end":return n.stop()}}),n)})))()},onAdd:function(){var t=this;return Object(o["a"])(Object(i["a"])().mark((function e(){return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getFromData();case 2:t.resetTemp(),t.dialogFormVisible=!0,t.dialogStatus="create";case 5:case"end":return e.stop()}}),e)})))()},getFromData:function(){var t=this;return Object(o["a"])(Object(i["a"])().mark((function e(){var n,r;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.listLoading=!0,e.next=3,t.getDomainList();case 3:return e.next=5,t.getServerList();case 5:for(n in t.chooseServerList=[],t.chooseDomainList=[],t.domainValueId=void 0,t.serverValue=[],t.domainData)t.chooseDomainList.push({value:t.domainData[n]["id"],label:t.domainData[n]["domain"]});for(r in t.serverData)t.chooseServerList.push({value:t.serverData[r]["id"],label:t.serverData[r]["hostname"]});t.listLoading=!1;case 12:case"end":return e.stop()}}),e)})))()},resetTemp:function(){this.temp={id:void 0,first_domain_id:void 0,server_ids:[],certificate_domain:""},this.serverValue=[],this.domainValueId=void 0,this.domainValue=""},handleDelete:function(t){var e=this;f(t).then((function(t){0===t.code&&(e.dialogFormVisible=!1,e.getSslList())}))}}},v=g,_=n("2877"),S=Object(_["a"])(v,r,a,!1,null,null,null);e["default"]=S.exports}}]);